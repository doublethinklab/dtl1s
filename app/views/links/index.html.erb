<h4><%= link_to 'DoubleThink Lab DB', root_path %></h4>

<%= form_tag links_path, :method => 'get' do %>
  <p>
    <%= text_field_tag :url, params[:url], placeholder: 'Url' %>
    <%= text_field_tag :description, params[:description], placeholder: 'Link description' %>
    <%= text_field_tag :start_date, params[:start_date], placeholder: 'Start Date' %>
    <%= text_field_tag :end_date, params[:end_date], placeholder: 'End Date' %>
    <%= submit_tag "Search", :name => nil %>
  </p>
<% end %>

<h4><%= @links.count %> Results</h4>

<table>
<% @link_by_domains.each do |link| %>
    <%= render "links/group", params: {link: {url: link[0], counts: link[1]}} %>
<% end %>
</table>

<hr>

<table>
<% @link_by_counts.each do |link| %>
    <%= render "links/group", params: {link: {url: link[0], counts: link[1]}} %>
<% end %>
</table>

<table>

<hr>

<% @links.each do |link| %>
<tr>
    <td><%= link_to 'â†–', "#{link.url}", target: "_blank" %></td>
    <%= render "layouts/ct", params: {ct: link.url} %>
    <td><%= link_to link.post.date, post_path(id: link.post_id), title: link.post.archive %></td>
    <td><%= link_to link.post.title ? link.post.title.truncate(30) : link.post.node.archive['name'], link.post.url, target: "_blank" %></td>
    <td><%= link_to (link.url ? link.url.truncate(30) : ''), (link.url ? link.url : ''), target: '_blank' %></td>
</tr>
<% end %>
</table>