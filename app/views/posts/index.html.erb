<%= form_tag posts_path, :method => 'get' do %>
  <%= render "layouts/search_txt", params: params %>
  <%= render "layouts/search", params: params %>
<% end %>
<% params[:description].split('+').each do |x| %>
  <%= link_to "#{x} ❌", posts_path(params: {description: params[:description].gsub("#{x}+",'').gsub("#{x}",''), start_date: params[:start_date] || @genes[:date], end_date: params[:end_date] || @genes[:date]}) %>
<% end if params[:description] %>

<% @genes.each do |g| %>
  <% if g[1]['tag'] %>
  <% word = URI.decode g[1]['tag'] %>
  <%= link_to word, posts_path(params: {description: (params[:description] ? word+'+'+params[:description] : word), start_date: params[:start_date] || @genes[:date], end_date: params[:end_date] || @genes[:date]}) unless params[:description].split('+').include? word %>
<% end %>
<% end %>
<h4><%= @posts.count %> Results (Posts) </h4>
<h5><%= "#{@first_date}" %></h5>
<h5><%= "#{@last_date}" %></h5>


<h5>

<% @type_counts.each do |t| %>
<%= "#{t[0]}: #{t[1]}, " %>
<% end %>
</h5>

<h5>
<% @posts_date.each do |pd| %>
  <%= link_to "#{pd[0]}: #{pd[1]}", posts_path(params: {description: params[:description], start_date: pd[0], end_date: pd[0]}) %><br>
<% end %>
</h5>



<table>
<% @posts.each do |post| %>
<tr>
    <td><%= link_to '🔗', post.url, target: '_blank' %></td>
    <td><%= post.link ? (link_to post.updated, post_path(post), title: post.archive) : post.updated %></td>
    <td><%= media_icon(post.node.archive['source']) %></td>
    <td><%= post.title ? post.title.truncate(40) : 'post' %></td>
    <td><%# post.score %></td>
</tr>

<% end %>
</table>